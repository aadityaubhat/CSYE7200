{"paragraphs":[{"text":"%md\n#Introduction\nThis notebook cleans the data for Santander Product Recommendation competition.\n","dateUpdated":"2016-12-01T05:20:37-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480564793511_-1581593771","id":"20161130-225953_1582619578","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Introduction</h1>\n<p>This notebook cleans the data for Santander Product Recommendation competition.</p>\n"},"dateCreated":"2016-11-30T22:59:53-0500","dateStarted":"2016-12-01T05:20:37-0500","dateFinished":"2016-12-01T05:20:37-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2132"},{"text":"%md\n#Data Loading\n\n\nLoading required libraries.","dateUpdated":"2016-12-01T05:20:39-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480565337824_-664357850","id":"20161130-230857_201075408","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Data Loading</h1>\n<p>Loading required libraries.</p>\n"},"dateCreated":"2016-11-30T23:08:57-0500","dateStarted":"2016-12-01T05:20:39-0500","dateFinished":"2016-12-01T05:20:39-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2133"},{"text":"%dep\nz.reset()\nz.addRepo(\"Spark Packages Repo\").url(\"http://dl.bintray.com/spark-packages/maven\")\nz.load(\"com.databricks:spark-csv_2.10:1.2.0\")\n\n\nimport org.apache.spark.sql.functions.udf\n\nimport util.Random._","dateUpdated":"2016-12-01T05:20:42-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480449196874_-1941193032","id":"20161129-145316_1193023666","result":{"code":"SUCCESS","type":"TEXT","msg":"DepInterpreter(%dep) deprecated. Remove dependencies and repositories through GUI interpreter menu instead.\nDepInterpreter(%dep) deprecated. Add repository through GUI interpreter menu instead.\nDepInterpreter(%dep) deprecated. Load dependency through GUI interpreter menu instead.\nimport org.apache.spark.sql.functions.udf\nimport util.Random._\n"},"dateCreated":"2016-11-29T14:53:16-0500","dateStarted":"2016-12-01T05:20:42-0500","dateFinished":"2016-12-01T05:20:51-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2134"},{"text":"%md\nLoading the data from csv file using spark-csv library. \nCreating spark DataFrame from the loaded data. \nRegistering the DataFrame as temp table to query it using spark-sql.","dateUpdated":"2016-12-01T05:21:04-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480565483826_1328054200","id":"20161130-231123_1605224947","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Loading the data from csv file using spark-csv library.\n<br  />Creating spark DataFrame from the loaded data.\n<br  />Registering the DataFrame as temp table to query it using spark-sql.</p>\n"},"dateCreated":"2016-11-30T23:11:23-0500","dateStarted":"2016-12-01T05:21:04-0500","dateFinished":"2016-12-01T05:21:04-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2135"},{"text":"  val trainData = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").option(\"inferSchema\", \"true\").load(\"/Users/aadityabhat/Downloads/train_ver2.csv\")\n  \n  trainData.toDF().registerTempTable(\"Data\")","dateUpdated":"2016-12-01T05:21:32-0500","config":{"colWidth":12,"graph":{"mode":"table","height":161,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480180876266_-727621334","id":"20161126-122116_458867020","result":{"code":"SUCCESS","type":"TEXT","msg":"trainData: org.apache.spark.sql.DataFrame = [fecha_dato: string, ncodpers: double, ind_empleado: string, pais_residencia: string, sexo: string, age: string, fecha_alta: string, ind_nuevo: string, antiguedad: string, indrel: string, ult_fec_cli_1t: string, indrel_1mes: string, tiprel_1mes: string, indresi: string, indext: string, conyuemp: string, canal_entrada: string, indfall: string, tipodom: string, cod_prov: string, nomprov: string, ind_actividad_cliente: string, renta: double, segmento: string, ind_ahor_fin_ult1: int, ind_aval_fin_ult1: int, ind_cco_fin_ult1: int, ind_cder_fin_ult1: int, ind_cno_fin_ult1: int, ind_ctju_fin_ult1: int, ind_ctma_fin_ult1: int, ind_ctop_fin_ult1: int, ind_ctpp_fin_ult1: int, ind_deco_fin_ult1: int, ind_deme_fin_ult1: int, ind_dela_fin_ult1: int, ind_ec..."},"dateCreated":"2016-11-26T12:21:16-0500","dateStarted":"2016-12-01T05:21:32-0500","dateFinished":"2016-12-01T05:22:31-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2136"},{"text":"%md\n#Data cleaning\n\nInvestigating the data type of the columns.\nChecking the columns with null values.\n","dateUpdated":"2016-12-01T05:22:44-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480565815349_172529015","id":"20161130-231655_247914854","result":{"code":"SUCCESS","type":"HTML","msg":"<h1>Data cleaning</h1>\n<p>Investigating the data type of the columns.\n<br  />Checking the columns with null values.</p>\n"},"dateCreated":"2016-11-30T23:16:55-0500","dateStarted":"2016-12-01T05:22:44-0500","dateFinished":"2016-12-01T05:22:44-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2137"},{"text":"trainData.printSchema()","dateUpdated":"2016-12-01T05:23:01-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480565986648_-1579203723","id":"20161130-231946_1414714797","result":{"code":"SUCCESS","type":"TEXT","msg":"root\n |-- fecha_dato: string (nullable = true)\n |-- ncodpers: double (nullable = true)\n |-- ind_empleado: string (nullable = true)\n |-- pais_residencia: string (nullable = true)\n |-- sexo: string (nullable = true)\n |-- age: string (nullable = true)\n |-- fecha_alta: string (nullable = true)\n |-- ind_nuevo: string (nullable = true)\n |-- antiguedad: string (nullable = true)\n |-- indrel: string (nullable = true)\n |-- ult_fec_cli_1t: string (nullable = true)\n |-- indrel_1mes: string (nullable = true)\n |-- tiprel_1mes: string (nullable = true)\n |-- indresi: string (nullable = true)\n |-- indext: string (nullable = true)\n |-- conyuemp: string (nullable = true)\n |-- canal_entrada: string (nullable = true)\n |-- indfall: string (nullable = true)\n |-- tipodom: string (nullable = true)\n |-- cod_prov: string (nullable = true)\n |-- nomprov: string (nullable = true)\n |-- ind_actividad_cliente: string (nullable = true)\n |-- renta: double (nullable = true)\n |-- segmento: string (nullable = true)\n |-- ind_ahor_fin_ult1: integer (nullable = true)\n |-- ind_aval_fin_ult1: integer (nullable = true)\n |-- ind_cco_fin_ult1: integer (nullable = true)\n |-- ind_cder_fin_ult1: integer (nullable = true)\n |-- ind_cno_fin_ult1: integer (nullable = true)\n |-- ind_ctju_fin_ult1: integer (nullable = true)\n |-- ind_ctma_fin_ult1: integer (nullable = true)\n |-- ind_ctop_fin_ult1: integer (nullable = true)\n |-- ind_ctpp_fin_ult1: integer (nullable = true)\n |-- ind_deco_fin_ult1: integer (nullable = true)\n |-- ind_deme_fin_ult1: integer (nullable = true)\n |-- ind_dela_fin_ult1: integer (nullable = true)\n |-- ind_ecue_fin_ult1: integer (nullable = true)\n |-- ind_fond_fin_ult1: integer (nullable = true)\n |-- ind_hip_fin_ult1: integer (nullable = true)\n |-- ind_plan_fin_ult1: integer (nullable = true)\n |-- ind_pres_fin_ult1: integer (nullable = true)\n |-- ind_reca_fin_ult1: integer (nullable = true)\n |-- ind_tjcr_fin_ult1: integer (nullable = true)\n |-- ind_valo_fin_ult1: integer (nullable = true)\n |-- ind_viv_fin_ult1: integer (nullable = true)\n |-- ind_nomina_ult1: string (nullable = true)\n |-- ind_nom_pens_ult1: string (nullable = true)\n |-- ind_recibo_ult1: integer (nullable = true)\n\n"},"dateCreated":"2016-11-30T23:19:46-0500","dateStarted":"2016-12-01T05:23:01-0500","dateFinished":"2016-12-01T05:23:01-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2138"},{"text":"%md\n### 1. Sexo (Gender)\nFinding the distribution and null values.","dateUpdated":"2016-12-01T05:22:55-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480585061927_587312547","id":"20161201-043741_1268125372","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>1. Sexo (Gender)</h3>\n<p>Finding the distribution and null values.</p>\n"},"dateCreated":"2016-12-01T04:37:41-0500","dateStarted":"2016-12-01T05:22:55-0500","dateFinished":"2016-12-01T05:22:55-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2139"},{"text":"%sql \nselect sexo, count(1) from Data group by sexo","dateUpdated":"2016-12-01T05:23:07-0500","config":{"colWidth":12,"graph":{"mode":"table","height":128,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480573753808_-1874291108","id":"20161201-012913_165850282","result":{"code":"SUCCESS","type":"TABLE","msg":"sexo\t_c1\nH\t6195253\nV\t7424252\n\t27804\n","comment":"","msgTable":[[{"key":"_c1","value":"H"},{"key":"_c1","value":"6195253"}],[{"value":"V"},{"value":"7424252"}],[{"value":""},{"value":"27804"}]],"columnNames":[{"name":"sexo","index":0,"aggr":"sum"},{"name":"_c1","index":1,"aggr":"sum"}],"rows":[["H","6195253"],["V","7424252"],["","27804"]]},"dateCreated":"2016-12-01T01:29:13-0500","dateStarted":"2016-12-01T05:23:07-0500","dateFinished":"2016-12-01T05:23:56-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2140"},{"text":"%md\nReplacing the null values with H an V while maintaing the same ratio between genders.","dateUpdated":"2016-12-01T05:24:23-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480585155225_1923237873","id":"20161201-043915_1864654010","result":{"code":"SUCCESS","type":"HTML","msg":"<p>Replacing the null values with H an V while maintaing the same ratio between genders.</p>\n"},"dateCreated":"2016-12-01T04:39:15-0500","dateStarted":"2016-12-01T05:24:23-0500","dateFinished":"2016-12-01T05:24:23-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2141"},{"text":"//\n\n\n\nval cleanSexo:(String => String) = (sexo:String) => {val r = new scala.util.Random;\n                                                    sexo.replace(\" \",\"\") match {case \"\" => if(r.nextFloat>0.54) \"V\" else \"H\" case a => a}}\n\nval cleanSexoUDF = udf(cleanSexo)\n\nval newTrainData = trainData.withColumn(\"newSexo\", cleanSexoUDF(col(\"sexo\")))\n\nnewTrainData.toDF().registerTempTable(\"newData\")\n\n//r.nextFloat","dateUpdated":"2016-12-01T05:36:56-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480573474587_1380504509","id":"20161201-012434_1503775016","result":{"code":"SUCCESS","type":"TEXT","msg":"\ncleanSexo: String => String = <function1>\n\ncleanSexoUDF: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,List(StringType))\nnewTrainData: org.apache.spark.sql.DataFrame = [fecha_dato: string, ncodpers: double, ind_empleado: string, pais_residencia: string, sexo: string, age: string, fecha_alta: string, ind_nuevo: string, antiguedad: string, indrel: string, ult_fec_cli_1t: string, indrel_1mes: string, tiprel_1mes: string, indresi: string, indext: string, conyuemp: string, canal_entrada: string, indfall: string, tipodom: string, cod_prov: string, nomprov: string, ind_actividad_cliente: string, renta: double, segmento: string, ind_ahor_fin_ult1: int, ind_aval_fin_ult1: int, ind_cco_fin_ult1: int, ind_cder_fin_ult1: int, ind_cno_fin_ult1: int, ind_ctju_fin_ult1: int, ind_ctma_fin_ult1: int, ind_ctop_fin_ult1: int, ind_ctpp_fin_ult1: int, ind_deco_fin_ult1: int, ind_deme_fin_ult1: int, ind_dela_fin_ult1: int, ind..."},"dateCreated":"2016-12-01T01:24:34-0500","dateStarted":"2016-12-01T05:36:46-0500","dateFinished":"2016-12-01T05:36:47-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2142"},{"text":"%md \n###2. Age \nChecking the distribution of age.","dateUpdated":"2016-12-01T05:39:31-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480585636772_906469123","id":"20161201-044716_1124470536","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>2. Age</h3>\n<p>Checking the distribution of age.</p>\n"},"dateCreated":"2016-12-01T04:47:16-0500","dateStarted":"2016-12-01T05:39:31-0500","dateFinished":"2016-12-01T05:39:31-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2143"},{"text":"%sql\nselect age, count(1) as count from Data  group by age","dateUpdated":"2016-12-01T05:39:36-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"age","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"age","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480450486970_-784418366","id":"20161129-151446_1953928383","result":{"code":"SUCCESS","type":"TABLE","msg":"age\tcount\n 50\t236383\n 51\t223297\n 52\t211611\n 53\t202527\n 54\t181511\n 55\t165355\n 56\t151340\n 57\t144645\n 58\t134739\n 59\t124177\n110\t261\n111\t252\n112\t188\n113\t117\n114\t22\n115\t82\n116\t63\n117\t14\n 60\t117834\n 61\t108356\n 62\t101186\n 63\t91521\n 64\t87398\n 65\t84750\n 66\t81343\n 67\t77693\n 68\t78361\n 69\t77745\n126\t3\n127\t8\n 70\t70192\n 71\t66825\n 72\t67664\n 73\t64431\n 74\t59086\n 75\t50597\n 76\t48997\n 77\t49218\n 78\t34358\n 79\t35065\n 10\t7950\n 11\t10481\n 12\t12546\n 13\t12745\n 14\t12667\n 15\t13118\n 16\t11759\n 17\t11953\n 18\t10989\n 19\t21597\n 80\t35773\n 81\t38217\n 82\t33938\n 83\t31860\n 84\t30124\n 85\t27754\n 86\t24956\n 87\t23648\n 88\t21718\n 89\t19175\n 20\t422867\n 21\t675988\n 22\t736314\n 23\t779884\n 24\t734785\n 25\t472016\n 26\t347778\n 27\t281981\n 28\t240192\n 29\t205709\n 90\t16863\n 91\t15098\n 92\t13492\n 93\t11642\n 94\t10085\n 95\t8511\n 96\t7480\n 97\t5962\n 98\t4622\n 99\t3617\n 30\t186040\n 31\t167985\n 32\t169537\n 33\t170477\n 34\t174574\n 35\t183577\n 36\t198422\n 37\t212420\n 38\t231963\n 39\t260548\n  2\t733\n  3\t1534\n  4\t2210\n  5\t3004\n  6\t3673\n  7\t3792\n  8\t4744\n  9\t5887\n 40\t287754\n 41\t309051\n 42\t319713\n163\t8\n 43\t324303\n164\t3\n 44\t322955\n 45\t314771\n 46\t299365\n 47\t286505\n 48\t271576\n 49\t250484\n100\t3050\n101\t2666\n102\t2335\n103\t2003\n104\t1350\n105\t1280\n106\t899\n107\t594\n108\t456\n109\t265\n NA\t27734\n","comment":"","msgTable":[[{"key":"count","value":" 50"},{"key":"count","value":"236383"}],[{"value":" 51"},{"value":"223297"}],[{"value":" 52"},{"value":"211611"}],[{"value":" 53"},{"value":"202527"}],[{"value":" 54"},{"value":"181511"}],[{"value":" 55"},{"value":"165355"}],[{"value":" 56"},{"value":"151340"}],[{"value":" 57"},{"value":"144645"}],[{"value":" 58"},{"value":"134739"}],[{"value":" 59"},{"value":"124177"}],[{"value":"110"},{"value":"261"}],[{"value":"111"},{"value":"252"}],[{"value":"112"},{"value":"188"}],[{"value":"113"},{"value":"117"}],[{"value":"114"},{"value":"22"}],[{"value":"115"},{"value":"82"}],[{"value":"116"},{"value":"63"}],[{"value":"117"},{"value":"14"}],[{"value":" 60"},{"value":"117834"}],[{"value":" 61"},{"value":"108356"}],[{"value":" 62"},{"value":"101186"}],[{"value":" 63"},{"value":"91521"}],[{"value":" 64"},{"value":"87398"}],[{"value":" 65"},{"value":"84750"}],[{"value":" 66"},{"value":"81343"}],[{"value":" 67"},{"value":"77693"}],[{"value":" 68"},{"value":"78361"}],[{"value":" 69"},{"value":"77745"}],[{"value":"126"},{"value":"3"}],[{"value":"127"},{"value":"8"}],[{"value":" 70"},{"value":"70192"}],[{"value":" 71"},{"value":"66825"}],[{"value":" 72"},{"value":"67664"}],[{"value":" 73"},{"value":"64431"}],[{"value":" 74"},{"value":"59086"}],[{"value":" 75"},{"value":"50597"}],[{"value":" 76"},{"value":"48997"}],[{"value":" 77"},{"value":"49218"}],[{"value":" 78"},{"value":"34358"}],[{"value":" 79"},{"value":"35065"}],[{"value":" 10"},{"value":"7950"}],[{"value":" 11"},{"value":"10481"}],[{"value":" 12"},{"value":"12546"}],[{"value":" 13"},{"value":"12745"}],[{"value":" 14"},{"value":"12667"}],[{"value":" 15"},{"value":"13118"}],[{"value":" 16"},{"value":"11759"}],[{"value":" 17"},{"value":"11953"}],[{"value":" 18"},{"value":"10989"}],[{"value":" 19"},{"value":"21597"}],[{"value":" 80"},{"value":"35773"}],[{"value":" 81"},{"value":"38217"}],[{"value":" 82"},{"value":"33938"}],[{"value":" 83"},{"value":"31860"}],[{"value":" 84"},{"value":"30124"}],[{"value":" 85"},{"value":"27754"}],[{"value":" 86"},{"value":"24956"}],[{"value":" 87"},{"value":"23648"}],[{"value":" 88"},{"value":"21718"}],[{"value":" 89"},{"value":"19175"}],[{"value":" 20"},{"value":"422867"}],[{"value":" 21"},{"value":"675988"}],[{"value":" 22"},{"value":"736314"}],[{"value":" 23"},{"value":"779884"}],[{"value":" 24"},{"value":"734785"}],[{"value":" 25"},{"value":"472016"}],[{"value":" 26"},{"value":"347778"}],[{"value":" 27"},{"value":"281981"}],[{"value":" 28"},{"value":"240192"}],[{"value":" 29"},{"value":"205709"}],[{"value":" 90"},{"value":"16863"}],[{"value":" 91"},{"value":"15098"}],[{"value":" 92"},{"value":"13492"}],[{"value":" 93"},{"value":"11642"}],[{"value":" 94"},{"value":"10085"}],[{"value":" 95"},{"value":"8511"}],[{"value":" 96"},{"value":"7480"}],[{"value":" 97"},{"value":"5962"}],[{"value":" 98"},{"value":"4622"}],[{"value":" 99"},{"value":"3617"}],[{"value":" 30"},{"value":"186040"}],[{"value":" 31"},{"value":"167985"}],[{"value":" 32"},{"value":"169537"}],[{"value":" 33"},{"value":"170477"}],[{"value":" 34"},{"value":"174574"}],[{"value":" 35"},{"value":"183577"}],[{"value":" 36"},{"value":"198422"}],[{"value":" 37"},{"value":"212420"}],[{"value":" 38"},{"value":"231963"}],[{"value":" 39"},{"value":"260548"}],[{"value":"  2"},{"value":"733"}],[{"value":"  3"},{"value":"1534"}],[{"value":"  4"},{"value":"2210"}],[{"value":"  5"},{"value":"3004"}],[{"value":"  6"},{"value":"3673"}],[{"value":"  7"},{"value":"3792"}],[{"value":"  8"},{"value":"4744"}],[{"value":"  9"},{"value":"5887"}],[{"value":" 40"},{"value":"287754"}],[{"value":" 41"},{"value":"309051"}],[{"value":" 42"},{"value":"319713"}],[{"value":"163"},{"value":"8"}],[{"value":" 43"},{"value":"324303"}],[{"value":"164"},{"value":"3"}],[{"value":" 44"},{"value":"322955"}],[{"value":" 45"},{"value":"314771"}],[{"value":" 46"},{"value":"299365"}],[{"value":" 47"},{"value":"286505"}],[{"value":" 48"},{"value":"271576"}],[{"value":" 49"},{"value":"250484"}],[{"value":"100"},{"value":"3050"}],[{"value":"101"},{"value":"2666"}],[{"value":"102"},{"value":"2335"}],[{"value":"103"},{"value":"2003"}],[{"value":"104"},{"value":"1350"}],[{"value":"105"},{"value":"1280"}],[{"value":"106"},{"value":"899"}],[{"value":"107"},{"value":"594"}],[{"value":"108"},{"value":"456"}],[{"value":"109"},{"value":"265"}],[{"value":" NA"},{"value":"27734"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[[" 50","236383"],[" 51","223297"],[" 52","211611"],[" 53","202527"],[" 54","181511"],[" 55","165355"],[" 56","151340"],[" 57","144645"],[" 58","134739"],[" 59","124177"],["110","261"],["111","252"],["112","188"],["113","117"],["114","22"],["115","82"],["116","63"],["117","14"],[" 60","117834"],[" 61","108356"],[" 62","101186"],[" 63","91521"],[" 64","87398"],[" 65","84750"],[" 66","81343"],[" 67","77693"],[" 68","78361"],[" 69","77745"],["126","3"],["127","8"],[" 70","70192"],[" 71","66825"],[" 72","67664"],[" 73","64431"],[" 74","59086"],[" 75","50597"],[" 76","48997"],[" 77","49218"],[" 78","34358"],[" 79","35065"],[" 10","7950"],[" 11","10481"],[" 12","12546"],[" 13","12745"],[" 14","12667"],[" 15","13118"],[" 16","11759"],[" 17","11953"],[" 18","10989"],[" 19","21597"],[" 80","35773"],[" 81","38217"],[" 82","33938"],[" 83","31860"],[" 84","30124"],[" 85","27754"],[" 86","24956"],[" 87","23648"],[" 88","21718"],[" 89","19175"],[" 20","422867"],[" 21","675988"],[" 22","736314"],[" 23","779884"],[" 24","734785"],[" 25","472016"],[" 26","347778"],[" 27","281981"],[" 28","240192"],[" 29","205709"],[" 90","16863"],[" 91","15098"],[" 92","13492"],[" 93","11642"],[" 94","10085"],[" 95","8511"],[" 96","7480"],[" 97","5962"],[" 98","4622"],[" 99","3617"],[" 30","186040"],[" 31","167985"],[" 32","169537"],[" 33","170477"],[" 34","174574"],[" 35","183577"],[" 36","198422"],[" 37","212420"],[" 38","231963"],[" 39","260548"],["  2","733"],["  3","1534"],["  4","2210"],["  5","3004"],["  6","3673"],["  7","3792"],["  8","4744"],["  9","5887"],[" 40","287754"],[" 41","309051"],[" 42","319713"],["163","8"],[" 43","324303"],["164","3"],[" 44","322955"],[" 45","314771"],[" 46","299365"],[" 47","286505"],[" 48","271576"],[" 49","250484"],["100","3050"],["101","2666"],["102","2335"],["103","2003"],["104","1350"],["105","1280"],["106","899"],["107","594"],["108","456"],["109","265"],[" NA","27734"]]},"dateCreated":"2016-11-29T15:14:46-0500","dateStarted":"2016-12-01T05:39:36-0500","dateFinished":"2016-12-01T05:40:25-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2144"},{"text":"%md\nreplacing NA with 0 and converting the data type to Int.","dateUpdated":"2016-12-01T04:50:17-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480576733512_-446073140","id":"20161201-021853_868170279","dateCreated":"2016-12-01T02:18:53-0500","dateStarted":"2016-12-01T04:50:14-0500","dateFinished":"2016-12-01T04:50:14-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2145"},{"text":"val cleanAgeFunc:(String => Int) = (age:String) => { age.replace(\" \",\"\") match {case \"NA\" => 0  case a => a.toInt}}\n\nval cleanAge = udf(cleanAgeFunc)\n\nval newTrainData2 = newTrainData.withColumn(\"newAge\", cleanAge(col(\"age\")))\n\nnewTrainData2.toDF().registerTempTable(\"newData2\")","dateUpdated":"2016-12-01T05:18:03-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480450591359_-1892324988","id":"20161129-151631_450722943","dateCreated":"2016-11-29T15:16:31-0500","dateStarted":"2016-12-01T04:56:35-0500","dateFinished":"2016-12-01T04:56:36-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2146"},{"text":"%sql\nselect newAge as Age, count(1) as count from newData group by newAge","dateUpdated":"2016-12-01T05:43:34-0500","config":{"colWidth":12,"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"keys":[{"name":"Age","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Age","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480451491553_956613614","id":"20161129-153131_496931187","dateCreated":"2016-11-29T15:31:31-0500","dateStarted":"2016-12-01T04:57:02-0500","dateFinished":"2016-12-01T04:57:56-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2147"},{"text":"%md \n###3. ind_nuevo (New Customer Index)\nChecking the null values in ind_nuevo.","dateUpdated":"2016-12-01T04:58:49-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480460553449_1335831166","id":"20161129-180233_1892479440","dateCreated":"2016-11-29T18:02:33-0500","dateStarted":"2016-12-01T04:58:46-0500","dateFinished":"2016-12-01T04:58:46-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2148"},{"text":"%sql\n\nselect ind_nuevo, count(1) from Data group by ind_nuevo","dateUpdated":"2016-12-01T02:56:59-0500","config":{"colWidth":12,"graph":{"mode":"table","height":124,"optionOpen":false,"keys":[{"name":"ind_nuevo","index":0,"aggr":"sum"}],"values":[{"name":"_c1","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"ind_nuevo","index":0,"aggr":"sum"},"yAxis":{"name":"_c1","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480578509586_-2062229770","id":"20161201-024829_501527694","dateCreated":"2016-12-01T02:48:29-0500","dateStarted":"2016-12-01T02:49:44-0500","dateFinished":"2016-12-01T02:50:36-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2149"},{"text":"%md\n\nThere are 27,734 null values for ind_nuevo. We check the number of months of history these customers have to set the new customer index.","dateUpdated":"2016-12-01T02:53:38-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480578580947_-1896528876","id":"20161201-024940_2037119987","dateCreated":"2016-12-01T02:49:40-0500","dateStarted":"2016-12-01T02:53:36-0500","dateFinished":"2016-12-01T02:53:36-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2150"},{"text":"%sql\nselect max(count) as maxCount from (select ncodpers, count(1) as count from (select ncodpers, fecha_dato from Data where ind_nuevo = \"NA\") tempTable group by ncodpers) tempTable2 ","dateUpdated":"2016-12-01T04:59:39-0500","config":{"colWidth":12,"graph":{"mode":"table","height":88,"optionOpen":false,"keys":[{"name":"_c0","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"_c0","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480578816984_-1120335459","id":"20161201-025336_1895408609","dateCreated":"2016-12-01T02:53:36-0500","dateStarted":"2016-12-01T04:59:39-0500","dateFinished":"2016-12-01T05:00:26-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2151"},{"text":"%md\nThe maximum months of history available for these customers is 6 months. Hence we can replace the NA values with 1, i.e we will be treating these customers as new customers.","dateUpdated":"2016-12-01T03:29:17-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480580785710_-1190742339","id":"20161201-032625_2135210110","dateCreated":"2016-12-01T03:26:25-0500","dateStarted":"2016-12-01T03:28:37-0500","dateFinished":"2016-12-01T03:28:37-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2152"},{"text":"val cleanInd_nuevo:(String => Int) = (ind_nuevo:String) => { ind_nuevo.replace(\" \",\"\") match {case \"NA\" => 1  case a => a.toInt}}\n\nval cleanInd_nuevoUDF = udf(cleanInd_nuevo)\n\nval newtrainData3 = newtrainData2.withColumn(\"newInd_nuevo\", cleanInd_nuevoUDF(col(\"ind_nuevo\")))\n\nnewTrainData3.toDF().registerTempTable(\"newData3\")\n\n","dateUpdated":"2016-12-01T05:19:05-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480579001739_-666084402","id":"20161201-025641_1305285534","dateCreated":"2016-12-01T02:56:41-0500","dateStarted":"2016-12-01T03:35:00-0500","dateFinished":"2016-12-01T03:35:00-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2153"},{"text":"%md\n###4. Antiguedad (Customer Seniority in Months) \nChecking the distribution for antiguedad.","dateUpdated":"2016-12-01T05:01:04-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480583275832_1374937873","id":"20161201-040755_1633889383","dateCreated":"2016-12-01T04:07:55-0500","dateStarted":"2016-12-01T05:01:02-0500","dateFinished":"2016-12-01T05:01:02-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2154"},{"text":"%sql \nselect antiguedad, count(*) as count from Data group by antiguedad order by antiguedad","dateUpdated":"2016-12-01T05:00:41-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"antiguedad","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"antiguedad","index":0,"aggr":"sum"}}},"enabled":true,"tableHide":false,"editorHide":false,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480581273698_1044725915","id":"20161201-033433_1129002001","dateCreated":"2016-12-01T03:34:33-0500","dateStarted":"2016-12-01T04:04:13-0500","dateFinished":"2016-12-01T04:05:01-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2155"},{"text":"%md\nCustomer seniority of -999,999 months doesn't make any sense. Replacing -999,999 by 0.","dateUpdated":"2016-12-01T04:27:14-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480582849940_-525754510","id":"20161201-040049_1674195974","dateCreated":"2016-12-01T04:00:49-0500","dateStarted":"2016-12-01T04:27:11-0500","dateFinished":"2016-12-01T04:27:11-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2156"},{"text":"val cleanAntigaudad:(String => Int) = (antigaudad:String) => { antigaudad.replace(\" \",\"\") match {case \"NA\" => 0  case a => if(a.toInt > 0) a.toInt else 0}}\n\nval cleanAntigaudadUDF = udf(cleanAntigaudad)\n\nval newtrainData4 = newtrainData3.withColumn(\"newAntigaudad\", cleanAntigaudadUDF(col(\"antiguedad\")))\n\nnewTrainData4.toDF().registerTempTable(\"newData4\")","dateUpdated":"2016-12-01T05:19:26-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480584431838_2106565004","id":"20161201-042711_552096001","dateCreated":"2016-12-01T04:27:11-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2157"}],"name":"Santander Data Cleaning","id":"2C18B1FD1","angularObjects":{"2BZAX45E6:shared_process":[],"2BZMHRSGY:shared_process":[],"2BZVNDHGR:shared_process":[],"2C3XPF5TA:shared_process":[],"2C1U8NNV7:shared_process":[],"2C3MA7WX5:shared_process":[],"2C2BETSJT:shared_process":[],"2C1RW3ZUQ:shared_process":[],"2C34ZY6KJ:shared_process":[],"2BZNFY2XE:shared_process":[],"2C35VCXST:shared_process":[],"2BYYVS2CF:shared_process":[],"2C2C27EAV:shared_process":[],"2C1TRHMET:shared_process":[],"2C2NSPBX4:shared_process":[],"2C31NSQ2U:shared_process":[],"2C3N6P5RD:shared_process":[],"2C33T27GC:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}